# Session One

# [View the recording](https://drive.google.com/open?id=1euq904sc49Ie1hhzOFQVnMxZf4UQ9bbV)

This document serves as a compliment (or an alternative) to the video recordings. Links mentioned in the recordings (as well as additional ones) can be found in their corresponding documents.

## Homework

- [Read this short section on the history of OCaml](https://www.cs.cornell.edu/courses/cs3110/2019sp/textbook/intro/ocaml.html#a-digression-on-the-history-of-ocaml)
- [Watch the first 13 minutes of Jared Forsyth's talk for brief intro and comparison of Reason to Flow, TypeScript and Elm](https://youtu.be/RV997YRIMZs)
- [Get a bit familiar with React Hooks](https://reactjs.org/docs/hooks-intro.html)

## Table of Contents

- [Reviewing Homework](#reviewing-homework) (0:00)
- [Learning Session Goals](#learning-session-goals) (0:39)
- [REPL Examples](#repl-examples) (1:23)
- [Explore Reason & BuckleScript](#explore-reason--bucklescript) (9:39)
- [Setting up a Development Environment](#setting-up-a-development-environment) (14:24)
- [Discord Channel](#discord-channel) (25:25)
- [DOM Manipulation](#dom-manipulation) (28:02)
- [Simple React Component](#simple-react-component) (38:04)
- [React Hooks](#react-hooks) (43:49)

## Reviewing Homework

It's very interesting that OCaml's type system's roots are in providing strong guarantees about correctness. Jared's talk illustrated the two ships representing JavaScript & OCaml. The JavaScript looks like a lot of fun, but there are some holes in the its hull. OCaml, on the other hand, has a safer looking hull, but lacks some of the playfulness found in JavaScript's boat. ReasonML has the goal of bring some of that playfullness to OCaml in a way that's appealing to the JavaScript community.

## Learning Session Goals

- Get a bit familiar with Reason by mapping on what we already know
- Write the <Collapse /> Homebase component together
- Learn how Reasonâ€™s type system can help offload invariants from our heads into the codebase
- Learn more idiomatic Reason

## REPL Examples

### Add

Reason:

```reason
let add = (a, b) => a + b;
```

Compiled JavaScript output:

```javascript
// Generated by BUCKLESCRIPT VERSION 5.0.4, PLEASE EDIT WITH CARE
'use strict'

function add(a, b) {
  return (a + b) | 0
}

exports.add = add
/* No side effect */
```

We immediately notice that the compiler--namely, BuckleScript--does some work to make the JavaScript both readable and performant.

### Animal

Reason:

```reason
let animal = "bear";

let matched = switch (animal) {
  | "bear" => Js.log("bear!");
  | "alligator" => Js.log("alligator!");
  | _ => Js.log("default!");
};
```

Compiled JavaScript output:

```javascript
// Generated by BUCKLESCRIPT VERSION 5.0.4, PLEASE EDIT WITH CARE
'use strict'

var animal = 'bear'

var matched

switch (animal) {
  case 'alligator':
    console.log('alligator!')
    matched = /* () */ 0
    break
  case 'bear':
    console.log('bear!')
    matched = /* () */ 0
    break
  default:
    console.log('default!')
    matched = /* () */ 0
}

exports.animal = animal
exports.matched = matched
/* matched Not a pure module */
```

### Record & Tuple

- [records](https://reasonml.github.io/docs/en/record)
- [tuples](https://reasonml.github.io/docs/en/tuples)

Reason:

```reason
type person = {
  name: string,
  age: int
};

let sue = {
  name: "Sue",
  age: 42
};

let sue = ("Sue", 42);
```

Compiled JavaScript output:

```javascript
// Generated by BUCKLESCRIPT VERSION 5.0.4, PLEASE EDIT WITH CARE
'use strict'

var sue = /* tuple */ ['Sue', 42]

exports.sue = sue
/* No side effect */
```

The first `sue` binding was [shadowed](https://reasonml.github.io/docs/en/let-binding#bindings-are-immutable).

## Explore Reason & BuckleScript

- https://reasonml.github.io/docs/en/what-and-why
- https://bucklescript.github.io/docs/en/what-why
- https://reasonml.github.io/reason-react/docs/en/what-and-why

Additional links:

- https://www.reactiflux.com/transcripts/cheng-lou/
- https://www.reactiflux.com/transcripts/jordan-walke/

**Different compilers work with the same OCaml AST and target different platforms.**
![](https://khoanguyen.me/reasonml-toolchain/bsb-vs-jsoo.png)
[source](https://khoanguyen.me/reasonml-toolchain/)

## Setting up a Development Environment

- [ReasonReact installation docs](https://reasonml.github.io/reason-react/docs/en/installation)
- [VSCode editor configuration](https://marketplace.visualstudio.com/items?itemName=jaredly.reason-vscode)
- [bsconfig.json schema info](https://bucklescript.github.io/docs/en/build-configuration#docsNav)
- [bsconfig.json full schema](https://bucklescript.github.io/bucklescript/docson/#build-schema.json)

## Discord Channel

- https://discordapp.com/invite/reasonml

## DOM Manipulation

- [Embed Raw JavaScript](https://bucklescript.github.io/docs/en/embed-raw-javascript)

Reason:

```reason
%raw
{|
  const button = document.createElement("button");
  const input = document.createElement("input");

  button.innerText = "Input Text";
  input.setAttribute("type", "text");

  button.addEventListener("click", () => {
    input.value = "Huzzah!";
  });

  document.body.appendChild(button);
  document.body.appendChild(input);
|};
```

Learn more about [strings and chars](https://reasonml.github.io/docs/en/string-and-char).

Compiled JavaScript output:

```javascript
// Generated by BUCKLESCRIPT VERSION 5.0.6, PLEASE EDIT WITH CARE

const button = document.createElement('button')
const input = document.createElement('input')

button.innerText = 'Input Text'
input.setAttribute('type', 'text')

button.addEventListener('click', () => {
  input.value = 'Huzzah!'
})

document.body.appendChild(button)
document.body.appendChild(input)

export {}
/*  Not a pure module */
```

### Bindings

- [Intro to `external`](https://bucklescript.github.io/docs/en/intro-to-external)

Reason:

```reason
type document;
type element;
[@bs.val] external document: document = "document";
[@bs.val] [@bs.scope "document"] external body: element = "body";
[@bs.send]
external createElement: (document, string) => element = "createElement";
[@bs.set] external innerText: (element, string) => unit = "innerText";
[@bs.set] external value: (element, string) => unit = "value";
[@bs.send]
external setAttribute: (element, string, string) => unit = "setAttribute";
[@bs.send]
external addEventListener: (element, string, unit => unit) => unit =
  "addEventListener";
[@bs.send] external appendChild: (element, element) => unit = "appendChild";

let button = createElement(document, "button");
let input = createElement(document, "input");

innerText(button, "Inner Text");
setAttribute(input, "type", "text");

addEventListener(button, "click", () => value(input, "Huzzah!"));

appendChild(body, button);
appendChild(body, input);
```

Note: we can also use the [pipe](https://reasonml.github.io/docs/en/pipe-first) operator to achieve the following syntax:

```reason
...
let button = document->createElement("button");
...
```

Compiled JavaScript output:

```javascript
// Generated by BUCKLESCRIPT VERSION 5.0.6, PLEASE EDIT WITH CARE

var button = document.createElement('button')

var input = document.createElement('input')

button.innerText = 'Inner Text'

input.setAttribute('type', 'text')

button.addEventListener('click', function(param) {
  input.value = 'Huzzah!'
  return /* () */ 0
})

document.body.appendChild(button)

document.body.appendChild(input)

export { button, input }
/* button Not a pure module */
```

## Simple React Component

React abstracts the DOM for us so that we don't have to worry about binding to the DOM. We just write functions and React handles the rest.

Reason:

```reason
[@react.component]
let make = (~src) => {
  <img src />;
};
```

Compiled JavaScript output:

```javascript
// Generated by BUCKLESCRIPT VERSION 5.0.6, PLEASE EDIT WITH CARE

import * as React from 'react'

function ReactTest(Props) {
  var src = Props.src
  return React.createElement('img', {
    src: src
  })
}

var make = ReactTest

export { make }
/* react Not a pure module */
```

- [Labeled Arguments](https://reasonml.github.io/docs/en/function#labeled-arguments)

## React Hooks

### useState

Reason:

```reason
[@react.component]
let make = () => {
  let (count, setCount) = React.useState(() => 0);

  <>
    <p> {React.string("Clicked " ++ string_of_int(count) ++ " times")} </p>
    <button onClick={_event => setCount(count => count + 1)}>
      {React.string("Increase")}
    </button>
    <button onClick={_event => setCount(count => count - 1)}>
      {React.string("Decrease")}
    </button>
  </>;
};
```

Compiled JavaScript output:

```javascript
// Generated by BUCKLESCRIPT VERSION 5.0.6, PLEASE EDIT WITH CARE

import * as Curry from '../node_modules/bs-platform/lib/es6/curry.js'
import * as React from 'react'

function ReactStateHook(Props) {
  var match = React.useState(function() {
    return 0
  })
  var setCount = match[1]
  return React.createElement(
    React.Fragment,
    undefined,
    React.createElement(
      'p',
      undefined,
      'Clicked ' + (String(match[0]) + ' times')
    ),
    React.createElement(
      'button',
      {
        onClick: function(_event) {
          return Curry._1(setCount, function(count) {
            return (count + 1) | 0
          })
        }
      },
      'Increase'
    ),
    React.createElement(
      'button',
      {
        onClick: function(_event) {
          return Curry._1(setCount, function(count) {
            return (count - 1) | 0
          })
        }
      },
      'Decrease'
    )
  )
}

var make = ReactStateHook

export { make }
/* react Not a pure module */
```

### useReducer

Reason:

```reason
type action =
  | Increment
  | Decrement;

[@react.component]
let make = () => {
  let (count, dispatch) =
    React.useReducer(
      (count, action) =>
        switch (action) {
        | Increment => count + 1
        | Decrement => count - 1
        },
      0,
    );

  <>
    <h1> {ReasonReact.string("Reducer!")} </h1>
    <p> {React.string("Clicked " ++ string_of_int(count) ++ " times")} </p>
    <button onClick={_event => dispatch(Increment)}>
      {React.string("Increase")}
    </button>
    <button onClick={_event => dispatch(Decrement)}>
      {React.string("Decrease")}
    </button>
  </>;
};
```

Compiled JavaScript output:

```javascript
// Generated by BUCKLESCRIPT VERSION 5.0.6, PLEASE EDIT WITH CARE

import * as Curry from '../node_modules/bs-platform/lib/es6/curry.js'
import * as React from 'react'

function ReactReducerHook(Props) {
  var match = React.useReducer(function(count, action) {
    if (action) {
      return (count - 1) | 0
    } else {
      return (count + 1) | 0
    }
  }, 0)
  var dispatch = match[1]
  return React.createElement(
    React.Fragment,
    undefined,
    React.createElement('h1', undefined, 'Reducer!'),
    React.createElement(
      'p',
      undefined,
      'Clicked ' + (String(match[0]) + ' times')
    ),
    React.createElement(
      'button',
      {
        onClick: function(_event) {
          return Curry._1(dispatch, /* Increment */ 0)
        }
      },
      'Increase'
    ),
    React.createElement(
      'button',
      {
        onClick: function(_event) {
          return Curry._1(dispatch, /* Decrement */ 1)
        }
      },
      'Decrease'
    )
  )
}

var make = ReactReducerHook

export { make }
/* react Not a pure module */
```

- [Variants](https://reasonml.github.io/docs/en/variant)
- [Pattern Matching](https://reasonml.github.io/docs/en/pattern-matching)
